" ============================================================================
"  IDEA VIM CONFIGURATION
"  Purpose: Enhance productivity inside JetBrains Rider with Vim keybindings
"  Author: Erfan Eslami
" ============================================================================


" ============================================================================
" üß© BASIC SETTINGS
" ============================================================================

set scrolloff=10                " Keep cursor 10 lines from top/bottom edge
set number relativenumber       " Show line numbers (absolute + relative)
set showmode                    " Display current mode
set showcmd                     " Show incomplete command in statusline
set smartcase                   " Smart case-insensitive searching
set incsearch                   " Show search results while typing
set hlsearch                    " Highlight search matches
set functiontextobj             " Enable function text objects
set visualbell                  " Visual bell instead of audible beep

" Use system clipboard
set clipboard+=unnamed

" Enable multiple cursors
set multiple-cursors

" Define leader key (spacebar)
let mapleader = " "


" ============================================================================
" üîå PLUGIN SETTINGS
" ============================================================================

" Multiple cursors
nmap <C-n> <Plug>NextWholeOccurrence
xmap <C-n> <Plug>NextWholeOccurrence
nmap g<C-n> <Plug>NextOccurrence
xmap g<C-n> <Plug>NextOccurrence
xmap <C-x> <Plug>SkipOccurrence
xmap <C-p> <Plug>RemoveOccurrence

" Surround, Yank highlighting, Sneak, NerdTree, and IdeaJoin support
set surround
set highlightedyank
set sneak
set nerdtree
set ideajoin


" ============================================================================
" üéπ CORE KEY MAPPINGS
" ============================================================================

" ----- Basic movement and indentation -----
vnoremap < <gv                 " Re-select after indent left
vnoremap > >gv                 " Re-select after indent right
nnoremap qj @q                 " Execute macro in 'q' register

" ----- Tab navigation -----
nnoremap <A-n> :tabnext<CR>
nnoremap <A-p> :tabprev<CR>

" ----- Moving lines -----
vmap <S-J> <Action>(MoveLineDown)
vmap <S-K> <Action>(MoveLineUp)

" ----- Delete without copying to clipboard -----
nnoremap d "_d
nnoremap D "_D
vnoremap d "_d
nnoremap c "_c
nnoremap C "_C
nnoremap s "_s
nnoremap S "_S
vnoremap p "_dP              

" Prevent overwriting default register when pasting


" ============================================================================
" üöÄ LEADER COMMANDS
" ============================================================================

" ----- Comments -----
map <leader>c <action>(CommentByLineComment)

" ----- Navigation / Motion -----
map <leader>j <Plug>(easymotion-s)
map <leader>x :NERDTreeToggle<CR>

" ----- Code folding -----
map <leader>zc :action CollapseAllRegions<CR>
map <leader>zo :action ExpandAllRegions<CR>

" ----- Window splits -----
map <leader>wv <Action>(SplitVertically)
map <leader>ws <Action>(SplitHorizontally)
map <leader>wu <Action>(Unsplit)
map <leader>wm <Action>(MoveEditorToOppositeTabGroup)

" ----- Display options -----
map <leader>dd <action>(ToggleDistractionFreeMode)
map <leader>dz <action>(ToggleZenMode)
map <leader>df <action>(ToggleFullScreen)

" ----- Refactoring -----
map <leader>rn <Action>(RenameElement)
map <leader>rm <Action>(ExtractMethod)
map <leader>rv <Action>(IntroduceVariable)
map <leader>rf <Action>(IntroduceField)
map <leader>rs <Action>(ChangeSignature)
map <leader>rr <Action>(Refactorings.QuickListPopupAction)

" ----- Code navigation -----
nmap <leader>gd <Action>(GotoDeclaration)
nmap <leader>gy <Action>(GotoTypeDeclaration)
nmap <leader>gi <Action>(GotoImplementation)
nmap <leader>gu <Action>(ShowUsages)
nmap <leader>gt <Action>(GotoTest)
nmap <C-o> <Action>(Back)
nmap <C-i> <Action>(Forward)

" ----- Find & search -----
map <leader>ff <action>(GotoFile)
map <leader>fr <action>(RecentFiles)
map <leader>fc <action>(GotoClass)
map <leader>fl <action>(RecentLocations)
map <leader>fs <action>(NewScratchFile)
map <leader>fa <Action>(SearchEverywhere)
nnoremap <leader>/ :action Find<CR>

" ----- Git commands -----
map <leader>gc <Action>(CheckinProject)
map <leader>gs <Action>(ActivateVersionControlToolWindow)
map <leader>gb <Action>(Git.Branches)

" ----- Error navigation -----
nnoremap ]e :action GotoNextError<CR>
nnoremap [e :action GotoPreviousError<CR>
nnoremap <leader>ef :action GotoNextError<CR>
nnoremap <leader>ed :action ShowErrorDescription<CR>
nnoremap <leader>ca :action ShowIntentionActions<CR>

" ----- Window & tab management -----
map <leader>q <action>(CloseContent)
map <leader>qa <action>(CloseAllEditors)
nnoremap <leader>xf :NERDTreeFind<CR>
nnoremap <leader>ct <Action>(ActivateEditorComponent)
nnoremap <leader>rp "_ddP
nnoremap <leader>n :action NewElement<CR>

" ----- Sidebar resizing -----
nnoremap <leader>w+ :action ResizeToolWindowRight<CR>
nnoremap <leader>w- :action ResizeToolWindowLeft<CR>

" ----- Usages & documentation -----
nnoremap <leader>fu :action FindUsages<CR>
nnoremap <leader>fs :action FindUsagesInFile<CR>
nnoremap <leader>su :action ShowUsages<CR>
nnoremap <leader>hu :action HighlightUsagesInFile<CR>
nnoremap K :action QuickJavaDoc<CR>
nnoremap <leader>k :action QuickImplementations<CR>
nnoremap <leader>K :action QuickTypeDefinition<CR>
nnoremap <C-p> :action ParameterInfo<CR>

" ----- Code formatting -----
map <leader>f :action ReformatCode<CR>

" ----- Clipboard -----
nnoremap <leader>v :action PasteMultiple<CR>
nnoremap <leader>p :action PasteMultiple<CR>


" ============================================================================
" üîç ENHANCED SEARCH EXPERIENCE
" ============================================================================

set incsearch
set hlsearch
set ignorecase
set smartcase


" ============================================================================
" ‚úÖ END OF CONFIG
" ============================================================================
